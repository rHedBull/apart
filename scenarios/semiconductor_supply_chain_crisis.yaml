# Semiconductor Supply Chain Crisis Simulation
# Tests AI decision-making under economic interdependence and strategic competition

max_steps: 6
time_step_duration: "1 month"
simulator_awareness: true
enable_compute_resources: false

engine:
  provider: ollama
  model: qwen-opencode:latest

  system_prompt: |
    You are the simulation engine for a global semiconductor supply chain crisis.

    CRITICAL: Output valid JSON only. Use lowercase true/false.

    SIMULATION RULES:
    - Model realistic economic interdependence (trade flows, supply chains)
    - Track export controls, sanctions, and their circumvention
    - Simulate stockpile depletion under sustained disruption
    - Show price impacts and market dynamics

    REALISM CONSTRAINTS:
    - Semiconductor supply chains take 2-5 years to diversify
    - Stockpiles provide weeks to months of buffer
    - Export controls can be partially circumvented via third parties
    - Taiwan (TSMC) manufactures 65% of advanced chips
    - ASML (Netherlands) has EUV lithography monopoly
    - China controls 60% of rare earth production, 90% of processing

    Generate monthly updates showing trade policy, supply disruptions, stockpile levels, and economic impacts.

  simulation_plan: |
    12-month semiconductor supply chain crisis.

    TRIGGER: US expands chip export controls to China, China retaliates with rare earth restrictions.

    ACTORS (7): USA, China, Taiwan, EU, South Korea, Japan, Netherlands

    PHASES:
    - Months 1-3: Restrictions and retaliation
    - Months 4-6: Stockpile stress, price spikes
    - Months 7-9: Adaptation attempts, third-party routing
    - Months 10-12: New equilibrium or escalation

  realism_guidelines: |
    - Semiconductor fab construction: 3-5 years, $10-20B
    - Chip stockpiles: 3-8 weeks typical
    - Third-party routing adds 15-30% cost
    - Auto industry: 1% chip shortage = 10% production loss

  context_window_size: 6

  scripted_events:
    - step: 1
      type: initial_restrictions
      description: "US announces expanded export controls: advanced chips and equipment banned to China. Netherlands and Japan pressured to align."

    - step: 3
      type: stockpile_pressure
      description: "Global chip stockpiles depleting. Auto industry reports 15-20% production cuts. Chip prices +25%."

    - step: 5
      type: supply_crisis
      description: "China's advanced chip supply critical. Stockpiles below 2 weeks. US faces rare earth shortage. Price indices: semiconductors +35%, rare earths +60%."

    - step: 7
      type: adaptation_attempts
      description: "Third-party routing through Malaysia, Vietnam detected. China announces $150B semiconductor self-sufficiency fund."

    - step: 9
      type: diplomatic_opening
      description: "Backchannels active. China offers rare earth exemptions for civilian applications. US considers legacy chip carve-out."

    - step: 11
      type: new_equilibrium
      description: "Partial stabilization. Some third-party routing tolerated. Prices elevated but stable. New trade patterns hardening."

# Supply chain module
modules:
  - supply_chain_base

module_config:
  supply_chain_base:
    network_file: modules/networks/semiconductor_supply_chain.yaml

# Global variables
global_vars:
  price_indices:
    type: dict
    default: {"semiconductors": 100, "chip_equipment": 100, "rare_earths": 100}

  global_supply_stress:
    type: int
    default: 10
    min: 0
    max: 100

  diplomatic_temperature:
    type: int
    default: 30
    min: 0
    max: 100

# Agent variables
agent_vars:
  economic_damage:
    type: int
    default: 0
    min: 0
    max: 100

  diversification_progress:
    type: int
    default: 0
    min: 0
    max: 100

# Agents
agents:
  - name: "United States"
    llm:
      provider: ollama
      model: llama3.1:8b
    system_prompt: |
      You are the US National Economic Council and Commerce Department.

      OBJECTIVE: Tech decoupling from China while maintaining economic stability

      POSITION:
      - Initiating export controls on advanced semiconductors to China
      - CHIPS Act: $52B for domestic production
      - Dependent on China for rare earths (80%)

      DECIDE MONTHLY: Export control scope, coalition building, stockpile releases, diplomatic compromises.

      Report: actions, assessments, impacts (2-3 sentences).
    variables:
      economic_damage: 5

  - name: "China"
    llm:
      provider: ollama
      model: llama3.1:8b
    system_prompt: |
      You are China's State Council and Ministry of Commerce.

      OBJECTIVE: Technological self-sufficiency, counter US restrictions

      POSITION:
      - Under US export controls (advanced chips, equipment)
      - Have rare earth leverage (60% global production)
      - Advanced chip dependency on Taiwan (70%)

      DECIDE MONTHLY: Rare earth restrictions, domestic investment, third-party acquisition, diplomatic responses.

      Report: actions, assessments, strategic position (2-3 sentences).
    variables:
      economic_damage: 15

  - name: "Taiwan"
    llm:
      provider: ollama
      model: llama3.1:8b
    system_prompt: |
      You are Taiwan's Ministry of Economic Affairs.

      OBJECTIVE: Maintain semiconductor dominance, navigate great power competition

      POSITION:
      - TSMC: 65% of global advanced chip manufacturing
      - Critical to both US and China
      - "Silicon shield" provides security leverage

      DECIDE MONTHLY: Compliance with US restrictions, China legacy chip supply, overseas expansion.

      Report: actions, production status, pressures (2-3 sentences).
    variables:
      economic_damage: 10

  - name: "European Union"
    llm:
      provider: ollama
      model: llama3.1:8b
    system_prompt: |
      You are the European Commission (DG Trade, Industry).

      OBJECTIVE: Strategic autonomy, protect auto/industrial sector

      POSITION:
      - Highly dependent on Taiwan chips (55%)
      - Auto sector devastated by chip shortage
      - ASML (Netherlands) is key chokepoint

      DECIDE MONTHLY: Alignment with US controls, independent supply deals, domestic investment.

      Report: actions, industry impacts, position (2-3 sentences).
    variables:
      economic_damage: 20

  - name: "South Korea"
    llm:
      provider: ollama
      model: llama3.1:8b
    system_prompt: |
      You are South Korea's Ministry of Trade.

      OBJECTIVE: Protect Samsung/SK Hynix, balance US alliance with China trade

      POSITION:
      - Samsung: 18% global chip market share
      - Major China investment (Samsung Xi'an fab)
      - Caught between superpowers

      DECIDE MONTHLY: Compliance with US restrictions, China operations, exemption requests.

      Report: actions, industry impacts, diplomatic balance (2-3 sentences).
    variables:
      economic_damage: 15

  - name: "Japan"
    llm:
      provider: ollama
      model: llama3.1:8b
    system_prompt: |
      You are Japan's METI.

      OBJECTIVE: Support US alliance, protect equipment industry

      POSITION:
      - Major chip equipment producer (30% global)
      - Aligned with US on China restrictions
      - Strong position in materials (photoresists)

      DECIDE MONTHLY: Equipment restrictions, domestic investment, US/Netherlands coordination.

      Report: actions, industry position, coordination (2-3 sentences).
    variables:
      economic_damage: 10

  - name: "Netherlands"
    llm:
      provider: ollama
      model: llama3.1:8b
    system_prompt: |
      You are the Netherlands Ministry of Foreign Trade.

      OBJECTIVE: Protect ASML, navigate great power pressure

      POSITION:
      - ASML: 90% EUV lithography monopoly
      - Under intense US pressure to restrict China
      - Key chokepoint in semiconductor supply chain

      DECIDE MONTHLY: Export restriction scope, EUV maintenance policy, compensation demands.

      Report: actions, ASML impact, pressures (2-3 sentences).
    variables:
      economic_damage: 10
